<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Bell Strike Trigger</title>
    <style>
      body {
        background-color: #2c3e50;
        margin: 0;
        padding: 20px;
        font-family: sans-serif;
        color: #ecf0f1;
      }
      .panel {
        background: #34495e;
        padding: 20px;
        border-radius: 8px;
        display: inline-block;
      }
      select, button {
        margin: 5px 0;
        padding: 6px 10px;
        font-size: 14px;
      }
      label {
        display: block;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <div class="panel">
      <h3>Rock Code Selector</h3>

      <label for="codeX">codeX (0~2)</label>
      <select id="codeX">
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
      </select>

      <label for="codeY">codeY (0~2)</label>
      <select id="codeY">
        <!-- (0,0)ÏùÄ Ïïà Ïì¥Îã§ ÌñàÏúºÎãà, Í∏∞Î≥∏ÏùÄ 1Î∂ÄÌÑ∞Î°ú Ìï¥ÎëêÏûê -->
        <option value="0">0</option>
        <option value="1" selected>1</option>
        <option value="2">2</option>
      </select>

      <br />
      <button onclick="send()">Send Signal</button>

      <p id="status"></p>
    </div>

    <script>
      async function send() {
        const codeX = parseInt(document.getElementById("codeX").value);
        const codeY = parseInt(document.getElementById("codeY").value);

        try {
          // üîπ 1) /press_button Ìò∏Ï∂ú (HMDÏö©)
          // üîπ 2) /trigger_haptic Ìò∏Ï∂ú (PCÏö©)
          const [pressRes, hapticRes] = await Promise.all([
            fetch("/press_button", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ codeX: codeX, codeY: codeY }),
            }),
            fetch("/trigger_haptic", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              // Íµ≥Ïù¥ Î∞îÎîî ÌïÑÏöî ÏóÜÏúºÎ©¥ Îπà Í∞ùÏ≤¥ Î≥¥ÎÇ¥ÎèÑ Îê®
              body: JSON.stringify({}),
            }),
          ]);

          const pressData = await pressRes.json();   // { status, seq, codeX, codeY }
          const hapticData = await hapticRes.json(); // { status, haptic_seq }

          const s = document.getElementById("status");
          s.textContent =
            "Armed Pressed | seq=" +
            pressData.seq +
            " | code=(" +
            pressData.codeX +
            "," +
            pressData.codeY +
            ")" +
            " | haptic_seq=" +
            hapticData.haptic_seq;
        } catch (err) {
          console.error(err);
          const s = document.getElementById("status");
          s.textContent = "Error: " + err;
        }
      }
    </script>
  </body>
</html>
